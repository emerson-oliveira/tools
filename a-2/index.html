<!DOCTYPE html>
<html lang="pt-BR" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Interativo: A02:2021 Falhas Criptogr√°ficas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Calm Tech -->
    <!-- Application Structure Plan: A estrutura da aplica√ß√£o foi desenhada como um dashboard de p√°gina √∫nica com navega√ß√£o superior fixa, em vez de um documento linear. A abordagem √© tem√°tica, com se√ß√µes dedicadas a: "Vis√£o Geral", "Causas Comuns", "Identifica√ß√£o", "Explora√ß√£o por Plataforma" e "Recomenda√ß√µes". Esta arquitetura foi escolhida para melhorar a usabilidade, permitindo que os usu√°rios (desenvolvedores, analistas de seguran√ßa) acessem rapidamente a informa√ß√£o mais relevante para eles. A se√ß√£o "Explora√ß√£o por Plataforma" √© o n√∫cleo interativo, permitindo filtrar o conte√∫do pela tecnologia de interesse, o que √© muito mais eficiente do que ler um relat√≥rio completo. O fluxo do usu√°rio √©, portanto, n√£o-linear e orientado a tarefas, facilitando a s√≠ntese de informa√ß√µes complexas. -->
    <!-- Visualization & Content Choices: 
        - Report Info: Criticidade (baixa incid√™ncia vs. alto impacto). Goal: Informar/Comparar. Viz/Presentation: Gr√°fico de Barras (Chart.js/Canvas). Interaction: Tooltips. Justification: Visualizar a aparente contradi√ß√£o de forma clara. Library: Chart.js.
        - Report Info: Causas comuns de falhas. Goal: Organizar/Detalhar. Viz/Presentation: Grade de cart√µes interativos (HTML/CSS/JS). Interaction: Clique para revelar detalhes em um modal. Justification: Transforma uma lista est√°tica em um elemento de explora√ß√£o, focando a aten√ß√£o do usu√°rio em uma causa por vez. Library: Vanilla JS.
        - Report Info: M√©todos de identifica√ß√£o. Goal: Organizar/Processo. Viz/Presentation: Diagrama de fluxo com etapas (HTML/Tailwind Flexbox). Interaction: Hover para destacar. Justification: Apresenta o processo de teste de seguran√ßa de forma visual e sequencial. Library: Vanilla JS.
        - Report Info: Vulnerabilidades por tecnologia. Goal: Comparar/Detalhar. Viz/Presentation: Conte√∫do din√¢mico com abas/bot√µes (HTML/JS). Interaction: Clique para carregar dados da plataforma selecionada. Justification: Permite personaliza√ß√£o da informa√ß√£o, atendendo diretamente √† necessidade do usu√°rio. Library: Vanilla JS.
        - Report Info: Recomenda√ß√µes de mitiga√ß√£o. Goal: Informar/A√ß√£o. Viz/Presentation: Lista expans√≠vel/acorde√£o (HTML/JS). Interaction: Clique para expandir/recolher. Justification: Organiza um grande volume de texto de forma compacta e gerenci√°vel. Library: Vanilla JS.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* slate-50 */
            color: #1e293b; /* slate-800 */
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .nav-link {
            transition: color 0.3s, border-bottom-color 0.3s;
        }
        .nav-link.active {
            color: #0891b2; /* cyan-600 */
            border-bottom-color: #0891b2; /* cyan-600 */
        }
        .platform-btn.active {
            background-color: #0891b2; /* cyan-600 */
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
    </style>
</head>
<body class="antialiased">

    <header class="bg-white/80 backdrop-blur-lg shadow-sm sticky top-0 z-40">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex-shrink-0">
                    <h1 class="text-xl font-bold text-slate-800">
                        <span class="text-cyan-600">A02:2021</span> / Falhas Criptogr√°ficas
                    </h1>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="#overview" class="nav-link text-slate-600 hover:text-cyan-600 px-3 py-2 rounded-md text-sm font-medium border-b-2 border-transparent">Vis√£o Geral</a>
                        <a href="#causes" class="nav-link text-slate-600 hover:text-cyan-600 px-3 py-2 rounded-md text-sm font-medium border-b-2 border-transparent">Causas Comuns</a>
                        <a href="#identification" class="nav-link text-slate-600 hover:text-cyan-600 px-3 py-2 rounded-md text-sm font-medium border-b-2 border-transparent">Identifica√ß√£o</a>
                        <a href="#exploitation" class="nav-link text-slate-600 hover:text-cyan-600 px-3 py-2 rounded-md text-sm font-medium border-b-2 border-transparent">Explora√ß√£o</a>
                        <a href="#recommendations" class="nav-link text-slate-600 hover:text-cyan-600 px-3 py-2 rounded-md text-sm font-medium border-b-2 border-transparent">Recomenda√ß√µes</a>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">

        <section id="overview" class="mb-16 md:mb-24 scroll-mt-20">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold text-slate-900">O Paradoxo das Falhas Criptogr√°ficas</h2>
                <p class="mt-4 text-lg text-slate-600 max-w-3xl mx-auto">Esta se√ß√£o introdut√≥ria explora o que s√£o as falhas criptogr√°ficas (OWASP A02:2021), por que s√£o t√£o cr√≠ticas e a aparente contradi√ß√£o entre sua frequ√™ncia e seu potencial de dano. O objetivo √© fornecer um entendimento fundamental sobre a natureza e o impacto desses riscos de seguran√ßa.</p>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
                <div class="space-y-6">
                    <h3 class="text-2xl font-semibold text-slate-800">Defini√ß√£o e Criticidade</h3>
                    <p class="text-slate-600 leading-relaxed">As Falhas Criptogr√°ficas, anteriormente conhecidas como "Exposi√ß√£o de Dados Sens√≠veis", referem-se a defici√™ncias na forma como a criptografia √© aplicada. Isso n√£o significa que os algoritmos (como AES) est√£o quebrados, mas sim que sua implementa√ß√£o √© falha.</p>
                    <p class="text-slate-600 leading-relaxed">O impacto de uma explora√ß√£o bem-sucedida √© severo, podendo levar a vazamentos de dados massivos, perdas financeiras e danos irrepar√°veis √† reputa√ß√£o, mesmo que a probabilidade de detec√ß√£o por ferramentas automatizadas seja, por vezes, baixa.</p>
                </div>
                
                <div class="bg-white p-6 rounded-xl shadow-lg border border-slate-200">
                    <h3 class="text-xl font-semibold text-center mb-4">Incid√™ncia vs. Impacto</h3>
                    <div class="chart-container">
                        <canvas id="impactChart"></canvas>
                    </div>
                    <p class="text-center text-sm text-slate-500 mt-4">Visualiza√ß√£o do conceito: embora menos frequentes em alguns relat√≥rios, o potencial de dano √© desproporcionalmente alto.</p>
                </div>
            </div>
        </section>

        <hr class="my-16 md:my-24 border-slate-200">

        <section id="causes" class="mb-16 md:mb-24 scroll-mt-20">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold text-slate-900">Ra√≠zes do Problema: Causas Comuns</h2>
                <p class="mt-4 text-lg text-slate-600 max-w-3xl mx-auto">Aqui, detalhamos as principais causas que levam a falhas criptogr√°ficas. Em vez de uma lista est√°tica, voc√™ pode interagir com cada categoria para entender melhor os erros espec√≠ficos, exemplos pr√°ticos e as CWEs (Common Weakness Enumeration) associadas. A maioria das falhas decorre de erros humanos e de implementa√ß√£o, n√£o dos algoritmos em si.</p>
            </div>
            <div id="causes-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
            </div>
        </section>

        <hr class="my-16 md:my-24 border-slate-200">

        <section id="identification" class="scroll-mt-20 mb-16 md:mb-24">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold text-slate-900">Como Identificar as Falhas</h2>
                <p class="mt-4 text-lg text-slate-600 max-w-3xl mx-auto">A detec√ß√£o de falhas criptogr√°ficas exige uma abordagem multifacetada, combinando automa√ß√£o e an√°lise humana. Esta se√ß√£o ilustra as principais metodologias de teste (SAST, DAST e Revis√£o Manual) e como elas se complementam para fornecer uma cobertura de seguran√ßa abrangente ao longo do ciclo de vida de desenvolvimento de software (SDLC).</p>
            </div>
            <div class="flex flex-col md:flex-row justify-center items-center gap-4 md:gap-0 bg-white p-8 rounded-xl shadow-lg border border-slate-200">
                 <div class="text-center p-4 rounded-lg flex-1 transition-all duration-300 hover:bg-slate-100">
                    <div class="text-3xl mb-2">üî¨</div>
                    <h3 class="text-xl font-semibold text-cyan-700">SAST</h3>
                    <p class="text-slate-600 mt-2">An√°lise de c√≥digo-fonte est√°tico para encontrar chaves codificadas e algoritmos fracos antes da implanta√ß√£o.</p>
                </div>
                <div class="text-2xl text-slate-300 hidden md:block mx-4">‚Üí</div>
                <div class="text-2xl text-slate-300 md:hidden my-2">‚Üì</div>
                 <div class="text-center p-4 rounded-lg flex-1 transition-all duration-300 hover:bg-slate-100">
                    <div class="text-3xl mb-2">üì°</div>
                    <h3 class="text-xl font-semibold text-cyan-700">DAST</h3>
                    <p class="text-slate-600 mt-2">Teste da aplica√ß√£o em execu√ß√£o para detectar configura√ß√µes TLS fracas e falta de criptografia em tr√¢nsito.</p>
                </div>
                 <div class="text-2xl text-slate-300 hidden md:block mx-4">‚Üí</div>
                 <div class="text-2xl text-slate-300 md:hidden my-2">‚Üì</div>
                 <div class="text-center p-4 rounded-lg flex-1 transition-all duration-300 hover:bg-slate-100">
                    <div class="text-3xl mb-2">üßë‚Äçüíª</div>
                    <h3 class="text-xl font-semibold text-cyan-700">Revis√£o Manual</h3>
                    <p class="text-slate-600 mt-2">An√°lise humana e testes de penetra√ß√£o para encontrar falhas l√≥gicas complexas que ferramentas automatizadas perdem.</p>
                </div>
            </div>
        </section>

        <hr class="my-16 md:my-24 border-slate-200">

        <section id="exploitation" class="scroll-mt-20 mb-16 md:mb-24">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold text-slate-900">Explora√ß√£o por Plataforma</h2>
                <p class="mt-4 text-lg text-slate-600 max-w-3xl mx-auto">As falhas criptogr√°ficas manifestam-se de maneiras diferentes dependendo da tecnologia. Selecione uma plataforma para explorar suas vulnerabilidades comuns e cen√°rios de explora√ß√£o t√≠picos. Esta vis√£o focada ajuda a entender os riscos espec√≠ficos do seu ambiente de desenvolvimento.</p>
            </div>
            <div class="flex justify-center flex-wrap gap-3 mb-8">
                <button data-platform="node" class="platform-btn px-6 py-2 font-semibold text-slate-700 bg-white border border-slate-300 rounded-full shadow-sm transition-all duration-300 hover:bg-slate-100">Node.js</button>
                <button data-platform="react" class="platform-btn px-6 py-2 font-semibold text-slate-700 bg-white border border-slate-300 rounded-full shadow-sm transition-all duration-300 hover:bg-slate-100">React/Next.js</button>
                <button data-platform="react-native" class="platform-btn px-6 py-2 font-semibold text-slate-700 bg-white border border-slate-300 rounded-full shadow-sm transition-all duration-300 hover:bg-slate-100">React Native</button>
                <button data-platform="python" class="platform-btn px-6 py-2 font-semibold text-slate-700 bg-white border border-slate-300 rounded-full shadow-sm transition-all duration-300 hover:bg-slate-100">Python</button>
            </div>
            <div id="exploitation-content" class="bg-white p-6 md:p-8 rounded-xl shadow-lg border border-slate-200 min-h-[300px]">
            </div>
        </section>

        <hr class="my-16 md:my-24 border-slate-200">
        
        <section id="recommendations" class="scroll-mt-20">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold text-slate-900">Mitiga√ß√£o: Recomenda√ß√µes Acion√°veis</h2>
                 <p class="mt-4 text-lg text-slate-600 max-w-3xl mx-auto">A preven√ß√£o de falhas criptogr√°ficas requer uma estrat√©gia de seguran√ßa em camadas. Esta se√ß√£o final fornece uma lista de recomenda√ß√µes essenciais. Interaja com cada t√≥pico para expandir e ver os detalhes, transformando conhecimento em a√ß√µes concretas para proteger suas aplica√ß√µes.</p>
            </div>
            <div id="recommendations-list" class="space-y-4 max-w-4xl mx-auto">
            </div>
        </section>
    </main>

    <footer class="bg-slate-800 text-slate-400 mt-24">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-6 text-center text-sm">
            <p>Dashboard Interativo baseado no relat√≥rio OWASP Top 10 A02:2021.</p>
            <p>Criado para fins educacionais.</p>
        </div>
    </footer>

    <div id="modal-container" class="fixed inset-0 bg-black bg-opacity-60 z-50 flex items-center justify-center p-4 hidden">
        <div id="modal-content" class="bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto">
             <div class="flex justify-between items-center p-4 border-b border-slate-200 sticky top-0 bg-white">
                <h3 id="modal-title" class="text-xl font-bold text-slate-800"></h3>
                <button id="modal-close" class="text-slate-500 hover:text-slate-800 transition-colors">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            </div>
            <div id="modal-body" class="p-6">
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const causesData = {
                'no-crypto': {
                    title: 'Nenhuma Criptografia Utilizada',
                    icon: 'üö´',
                    description: 'Dados sens√≠veis s√£o transmitidos ou armazenados em texto simples, tornando-os vulner√°veis √† intercepta√ß√£o.',
                    details: '<strong>Problema:</strong> Aus√™ncia de TLS para dados em tr√¢nsito ou n√£o criptografar dados em repouso em bancos de dados ou arquivos. <br><br><strong>Exemplo:</strong> Um formul√°rio de login que envia senhas por HTTP, ou um banco de dados de clientes com informa√ß√µes pessoais armazenadas sem criptografia.',
                    cwe: 'CWE-311, CWE-312'
                },
                'weak-algo': {
                    title: 'Algoritmos Fracos ou Depreciados',
                    icon: 'üìâ',
                    description: 'Uso de algoritmos criptograficamente quebrados ou desatualizados.',
                    details: '<strong>Problema:</strong> Algoritmos como MD5, SHA1, DES, e RC4 s√£o vulner√°veis a ataques de colis√£o, for√ßa bruta e outras t√©cnicas modernas.<br><br><strong>Exemplo:</strong> Armazenar hashes de senha usando MD5, que pode ser facilmente quebrado com tabelas rainbow.',
                    cwe: 'CWE-327'
                },
                'key-management': {
                    title: 'Gerenciamento Inadequado de Chaves',
                    icon: 'üîë',
                    description: 'Chaves criptogr√°ficas codificadas, reutilizadas ou armazenadas de forma insegura.',
                    details: '<strong>Problema:</strong> Chaves no c√≥digo-fonte, em arquivos de configura√ß√£o n√£o protegidos, ou a falta de rota√ß√£o de chaves.<br><br><strong>Exemplo:</strong> Uma chave de API para um servi√ßo de pagamento codificada diretamente no c√≥digo de uma aplica√ß√£o mobile, onde pode ser extra√≠da por engenharia reversa.',
                    cwe: 'CWE-547, CWE-798'
                },
                'bad-random': {
                    title: 'Gera√ß√£o Insegura de N√∫meros Aleat√≥rios',
                    icon: 'üé≤',
                    description: 'Uso de geradores de n√∫meros pseudoaleat√≥rios n√£o seguros para fins criptogr√°ficos.',
                    details: '<strong>Problema:</strong> Fun√ß√µes como `Math.random()` (JS) ou `random` (Python) produzem sequ√™ncias previs√≠veis, enfraquecendo chaves, salts e tokens.<br><br><strong>Exemplo:</strong> Gerar um token de redefini√ß√£o de senha com `Math.random()`, permitindo que um atacante preveja tokens v√°lidos.',
                    cwe: 'CWE-338'
                },
                'tls-config': {
                    title: 'Configura√ß√£o Incorreta de SSL/TLS',
                    icon: '‚öôÔ∏è',
                    description: 'Conex√µes vulner√°veis devido a configura√ß√µes de TLS deficientes.',
                    details: '<strong>Problema:</strong> Suporte a protocolos antigos (SSLv3, TLS 1.0/1.1), cifras fracas, certificados expirados ou autoassinados, e falta do cabe√ßalho HSTS.<br><br><strong>Exemplo:</strong> Um servidor que permite uma conex√£o TLS 1.0 com uma cifra de exporta√ß√£o, vulner√°vel a ataques de downgrade como o FREAK.',
                    cwe: 'CWE-326'
                },
                'weak-hash': {
                    title: 'Hash de Senha Fraco',
                    icon: 'üõ°Ô∏è',
                    description: 'Armazenamento de senhas com hashes r√°pidos, n√£o salgados ou em texto simples.',
                    details: '<strong>Problema:</strong> O uso de hashes r√°pidos (MD5, SHA1) sem um salt √∫nico por usu√°rio permite ataques de for√ßa bruta offline e de tabelas rainbow.<br><br><strong>Exemplo:</strong> A famosa viola√ß√£o do LinkedIn em 2012, onde milh√µes de hashes de senha SHA1 (sem salt) foram vazados e quebrados.',
                    cwe: 'CWE-916'
                }
            };
            const exploitationData = {
                node: {
                    title: 'Node.js',
                    vulnerabilities: [
                        '<strong>Gerenciamento Inseguro de Chaves:</strong> Chaves em arquivos de configura√ß√£o, logs, ou vazamento de mem√≥ria do `Buffer`.',
                        '<strong>Algoritmos Fracos:</strong> Uso de algoritmos como DES no m√≥dulo `crypto` nativo.',
                        '<strong>Gera√ß√£o Insegura de Aleat√≥rios:</strong> Depend√™ncia de PRNGs fracos para tokens.',
                        '<strong>Vulnerabilidades de Depend√™ncia:</strong> Uso de vers√µes antigas do Node.js ou pacotes npm vulner√°veis.'
                    ],
                    scenarios: [
                        '<strong>Ataques Man-in-the-Middle (MITM):</strong> Intercepta√ß√£o de tr√°fego se o TLS n√£o for for√ßado.',
                        '<strong>Roubo de Sess√£o:</strong> Previs√£o de IDs de sess√£o gerados de forma insegura.',
                        '<strong>Vazamento de Mem√≥ria:</strong> Objetos `Buffer` n√£o limpos podem expor dados sens√≠veis de requisi√ß√µes anteriores.',
                        '<strong>Bypass de Permiss√µes:</strong> Falhas em `worker_threads` podem permitir escalonamento de privil√©gios.'
                    ]
                },
                react: {
                    title: 'React.js / Next.js',
                    vulnerabilities: [
                        '<strong>Exposi√ß√£o no Cliente (React):</strong> Armazenar tokens ou chaves em `localStorage` os torna vulner√°veis a XSS.',
                        '<strong>Chaves P√∫blicas (Next.js):</strong> Vari√°veis de ambiente com prefixo `NEXT_PUBLIC_` s√£o expostas no bundle do cliente.',
                        '<strong>Gerenciamento Inseguro de Chaves (Next.js):</strong> Chaves de API expostas em fun√ß√µes de API ou middleware.',
                        '<strong>Vulnerabilidades de Middleware (Next.js):</strong> Falhas podem permitir o bypass de verifica√ß√µes de autentica√ß√£o.'
                    ],
                    scenarios: [
                        '<strong>Roubo de Token via XSS:</strong> Um script malicioso injetado l√™ o token JWT do `localStorage` e o envia para um atacante.',
                        '<strong>Extra√ß√£o de Chaves do Bundle:</strong> Um atacante analisa o c√≥digo JavaScript p√∫blico para encontrar chaves de API expostas.',
                        '<strong>Bypass de Autoriza√ß√£o (Next.js):</strong> Manipula√ß√£o de cabe√ßalhos internos para pular a execu√ß√£o do middleware de seguran√ßa.',
                        '<strong>Ataques MITM:</strong> Se o HTTPS n√£o for universalmente for√ßado, o tr√°fego pode ser interceptado.'
                    ]
                },
                'react-native': {
                    title: 'React Native',
                    vulnerabilities: [
                        '<strong>Armazenamento Inseguro de Dados:</strong> Salvar credenciais ou chaves em `AsyncStorage` ou SQLite em texto simples.',
                        '<strong>Chaves Hardcoded:</strong> Incorporar chaves de criptografia diretamente no c√≥digo do aplicativo.',
                        '<strong>Falta de Transporte Seguro:</strong> Comunica√ß√£o com APIs via HTTP ou falha em implementar SSL Pinning.',
                        '<strong>Algoritmos Fracos:</strong> Uso de bibliotecas de criptografia de terceiros com implementa√ß√µes fracas.'
                    ],
                    scenarios: [
                        '<strong>Acesso F√≠sico ao Dispositivo:</strong> Um atacante com acesso f√≠sico extrai dados do armazenamento local do aplicativo.',
                        '<strong>Engenharia Reversa:</strong> Descompila√ß√£o do APK/IPA para extrair chaves de criptografia codificadas.',
                        '<strong>Intercepta√ß√£o de Rede (MITM):</strong> Em uma rede Wi-Fi p√∫blica, um atacante intercepta o tr√°fego de rede da aplica√ß√£o por falta de SSL Pinning.',
                        '<strong>Malware:</strong> Outro aplicativo malicioso no dispositivo pode tentar ler os dados armazenados de forma insegura.'
                    ]
                },
                python: {
                    title: 'Python',
                    vulnerabilities: [
                        '<strong>Gera√ß√£o Insegura de Aleat√≥rios:</strong> Uso do m√≥dulo `random` em vez de `secrets` para fins criptogr√°ficos.',
                        '<strong>Hashing de Senha Fraco:</strong> Uso de MD5/SHA1 em vez de bibliotecas como `bcrypt` ou `argon2`.',
                        '<strong>Uso Inseguro de Bibliotecas:</strong> Uso incorreto de modos de cifra (ex: ECB) em PyCryptodome.',
                        '<strong>Deserializa√ß√£o Insegura:</strong> Uso de `pickle` com dados n√£o confi√°veis pode levar a RCE.'
                    ],
                    scenarios: [
                        '<strong>Previs√£o de Token:</strong> Atacante prev√™ tokens de redefini√ß√£o de senha gerados com `random.randint`.',
                        '<strong>Ataque de Tabela Rainbow:</strong> Quebra de senhas com hash MD5 vazadas de um banco de dados.',
                        '<strong>Ataque de Padding Oracle:</strong> Descriptografia de dados explorando mensagens de erro de preenchimento em implementa√ß√µes CBC.',
                        '<strong>Execu√ß√£o de C√≥digo Remoto:</strong> Um atacante envia um payload `pickle` malicioso que √© desserializado pelo servidor.'
                    ]
                }
            };
            const recommendationsData = [
                {
                    title: 'Classificar e Minimizar Dados',
                    icon: 'üìÇ',
                    content: 'Identifique todos os dados sens√≠veis que sua aplica√ß√£o processa. N√£o armazene informa√ß√µes sens√≠veis desnecessariamente e descarte-as assim que poss√≠vel. Criptografe todos os dados sens√≠veis em repouso e em tr√¢nsito.'
                },
                {
                    title: 'Usar Algoritmos e Protocolos Fortes',
                    icon: 'üîí',
                    content: 'Use sempre protocolos e algoritmos padr√£o e fortes, recomendados pela ind√∫stria (ex: AES-256, RSA-2048+, bcrypt, Argon2). Evite algoritmos depreciados como MD5, SHA1, DES. Para tr√¢nsito, use TLS 1.2+ com cifras fortes e HSTS.'
                },
                {
                    title: 'Gerenciamento Seguro de Chaves',
                    icon: 'üîë',
                    content: 'Nunca codifique chaves no c√≥digo-fonte. Utilize um sistema de gerenciamento de segredos (KMS) como AWS KMS, Azure Key Vault ou HashiCorp Vault. Garanta rota√ß√£o peri√≥dica de chaves e controle de acesso rigoroso.'
                },
                {
                    title: 'Implementar Testes de Seguran√ßa Cont√≠nuos',
                    icon: 'üß™',
                    content: 'Integre ferramentas SAST e DAST em seu pipeline de CI/CD para detec√ß√£o precoce. Realize revis√µes manuais de c√≥digo e testes de penetra√ß√£o regulares para encontrar vulnerabilidades complexas que a automa√ß√£o n√£o consegue detectar.'
                },
                {
                    title: 'Manter Depend√™ncias Atualizadas',
                    icon: 'üîÑ',
                    content: 'Mantenha todos os frameworks, bibliotecas e plataformas atualizados. Use ferramentas como `npm audit` ou `pip-audit` para verificar vulnerabilidades conhecidas em suas depend√™ncias e aplique patches prontamente.'
                }
            ];
            
            const impactChartCtx = document.getElementById('impactChart').getContext('2d');
            new Chart(impactChartCtx, {
                type: 'bar',
                data: {
                    labels: ['Potencial de Explora√ß√£o', 'Taxa de Incid√™ncia', 'Potencial de Impacto'],
                    datasets: [{
                        label: 'Classifica√ß√£o de Risco (OWASP)',
                        data: [8, 3, 9],
                        backgroundColor: [
                            'rgba(251, 146, 60, 0.6)', // orange-400
                            'rgba(56, 189, 248, 0.6)', // sky-400
                            'rgba(239, 68, 68, 0.6)'  // red-500
                        ],
                        borderColor: [
                            'rgba(251, 146, 60, 1)',
                            'rgba(56, 189, 248, 1)',
                            'rgba(239, 68, 68, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    scales: {
                        x: {
                            beginAtZero: true,
                            max: 10,
                            grid: { display: false }
                        },
                        y: {
                           grid: { color: '#e2e8f0' }
                        }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.x !== null) {
                                        label += `${context.parsed.x} de 10`;
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });

            const causesGrid = document.getElementById('causes-grid');
            Object.keys(causesData).forEach(key => {
                const cause = causesData[key];
                const card = document.createElement('div');
                card.className = 'bg-white p-6 rounded-xl shadow-lg border border-slate-200 cursor-pointer transition-all duration-300 hover:shadow-cyan-100 hover:border-cyan-300 hover:-translate-y-1';
                card.dataset.key = key;
                card.innerHTML = `
                    <div class="text-4xl mb-4">${cause.icon}</div>
                    <h3 class="text-xl font-semibold text-slate-800">${cause.title}</h3>
                    <p class="text-slate-500 mt-2">${cause.description}</p>
                `;
                card.addEventListener('click', () => showModal(key));
                causesGrid.appendChild(card);
            });
            
            const modalContainer = document.getElementById('modal-container');
            const modalClose = document.getElementById('modal-close');
            const modalTitle = document.getElementById('modal-title');
            const modalBody = document.getElementById('modal-body');

            function showModal(key) {
                const cause = causesData[key];
                modalTitle.textContent = cause.title;
                modalBody.innerHTML = `
                    <p class="text-slate-600 leading-relaxed">${cause.details}</p>
                    <div class="mt-6 pt-4 border-t border-slate-200">
                        <p class="text-sm font-semibold text-slate-700">CWEs Relevantes: <span class="font-normal text-cyan-700 bg-cyan-50 px-2 py-1 rounded">${cause.cwe}</span></p>
                    </div>
                `;
                modalContainer.classList.remove('hidden');
            }

            modalClose.addEventListener('click', () => modalContainer.classList.add('hidden'));
            modalContainer.addEventListener('click', (e) => {
                if (e.target === modalContainer) {
                    modalContainer.classList.add('hidden');
                }
            });

            const exploitationContent = document.getElementById('exploitation-content');
            const platformBtns = document.querySelectorAll('.platform-btn');

            function updateExploitationContent(platformKey) {
                const data = exploitationData[platformKey];
                if (!data) {
                    exploitationContent.innerHTML = `<p class="text-center text-slate-500">Selecione uma plataforma para ver os detalhes.</p>`;
                    return;
                }
                exploitationContent.innerHTML = `
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div>
                            <h3 class="text-xl font-semibold text-slate-800 mb-4 border-b-2 border-cyan-500 pb-2">Vulnerabilidades Comuns</h3>
                            <ul class="space-y-3 list-disc list-inside text-slate-600">
                                ${data.vulnerabilities.map(item => `<li>${item}</li>`).join('')}
                            </ul>
                        </div>
                        <div>
                            <h3 class="text-xl font-semibold text-slate-800 mb-4 border-b-2 border-red-500 pb-2">Cen√°rios de Explora√ß√£o</h3>
                            <ul class="space-y-3 list-disc list-inside text-slate-600">
                                ${data.scenarios.map(item => `<li>${item}</li>`).join('')}
                            </ul>
                        </div>
                    </div>
                `;
            }

            platformBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    const platform = btn.dataset.platform;
                    platformBtns.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    updateExploitationContent(platform);
                });
            });

            updateExploitationContent('node');
            document.querySelector('.platform-btn[data-platform="node"]').classList.add('active');

            const recommendationsList = document.getElementById('recommendations-list');
            recommendationsData.forEach(item => {
                const div = document.createElement('div');
                div.className = 'bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden';
                div.innerHTML = `
                    <button class="w-full flex justify-between items-center text-left p-4 font-semibold text-slate-700 hover:bg-slate-50 transition-colors">
                        <span class="flex items-center">
                            <span class="mr-3 text-2xl">${item.icon}</span>
                            <span>${item.title}</span>
                        </span>
                        <svg class="w-5 h-5 transition-transform shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div class="px-4 pb-4 text-slate-600 leading-relaxed hidden">
                        ${item.content}
                    </div>
                `;
                recommendationsList.appendChild(div);

                const button = div.querySelector('button');
                const content = div.querySelector('div');
                const chevron = div.querySelector('svg');

                button.addEventListener('click', () => {
                    content.classList.toggle('hidden');
                    chevron.classList.toggle('rotate-180');
                });
            });

            const navLinks = document.querySelectorAll('.nav-link');
            const sections = document.querySelectorAll('main section');
            
            window.addEventListener('scroll', () => {
                let current = '';
                sections.forEach(section => {
                    const sectionTop = section.offsetTop;
                    if (pageYOffset >= sectionTop - 80) {
                        current = section.getAttribute('id');
                    }
                });

                navLinks.forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('href').includes(current)) {
                        link.classList.add('active');
                    }
                });
            });
        });
    </script>
</body>
</html>
